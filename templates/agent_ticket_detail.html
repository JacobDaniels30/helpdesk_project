{% extends 'base.html' %}
{% block content %}
  <h2>Agent Ticket Detail</h2>

  <form method="POST" action="{{ url_for('agent_update_status', ticket_id=ticket.id) }}" class="update-form">
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
    
    <div class="form-group">
      <label for="status">Status</label>
      <select id="status" name="status" required>
        <option value="Open" {% if ticket.status == 'Open' %}selected{% endif %}>Open</option>
        <option value="In Progress" {% if ticket.status == 'In Progress' %}selected{% endif %}>In Progress</option>
        <option value="Resolved" {% if ticket.status == 'Resolved' %}selected{% endif %}>Resolved</option>
        <option value="Closed" {% if ticket.status == 'Closed' %}selected{% endif %}>Closed</option>
      </select>
    </div>

    <div class="form-group">
      <label for="internal_notes">Internal Notes</label>
      <textarea id="internal_notes" name="internal_notes" rows="3">{{ ticket.internal_notes or '' }}</textarea>
    </div>

    <button type="submit" class="btn btn-primary">Update Status</button>
  </form>

  <hr>

  <h3>Add Comment</h3>
  <form method="POST" action="{{ url_for('agent_add_comment', ticket_id=ticket.id) }}">
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
    
    <div class="form-group">
      <label for="comment">Comment</label>
      <textarea id="comment" name="comment" rows="4" required></textarea>
    </div>

    <button type="submit" class="btn btn-secondary">Add Comment</button>
  </form>

  <br>
  <a href="{{ url_for('agent_dashboard') }}">Back to Agent Dashboard</a>
{% endblock %}
